{"sqlViews":[{"id":"U5DK7LdyJre","name":"abandoned_dashboards_S","description":"Dashboards with 1 or fewer views over the past three years","sqlQuery":"select 'dashboard_used' as indicator, count(*)::varchar as value, (100*count(*)/(select count(*) from dashboard))||'%' as percent, 'Dashboards that have been viewed 1 time or less in the past three years' as description from dashboard where uid not in (select favoriteuid from datastatisticsevent where eventtype = 'DASHBOARD_VIEW' and favoriteuid is not null and extract(year from timestamp) >= ( extract(year from now()) -3 ) group by favoriteuid having count(*) >1);","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"Dfjw69AKQln","name":"abandoned_dashboards_D","description":"Dashboards with 1 or fewer views over the past three years","sqlQuery":"SELECT uid,name from dashboard where uid not in (select favoriteuid from datastatisticsevent where eventtype = 'DASHBOARD_VIEW' and favoriteuid is not null and extract(year from timestamp) >= ( extract(year from now()) -3 ) group by favoriteuid having count(*) >1) ORDER BY name;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"lY1DmLxMl7h","name":"aggregate_des_no_analysis_S","description":"Aggregate data elements not used in any favourites (directly or through indicators)","sqlQuery":"WITH des_no_analysis AS ( select name,uid from dataelement where domaintype = 'AGGREGATE' and dataelementid not in (select de.dataelementid from dataelement de left join indicator ind on (ind.numerator like '%'||de.uid||'%' or ind.denominator like '%'||de.uid||'%') where ind.name is not null and ind.indicatorid in (select indicatorid from datadimensionitem where indicatorid > 0)) and dataelementid not in (select dataelementoperand_dataelementid from datadimensionitem where dataelementoperand_dataelementid > 0) and dataelementid not in (select dataelementid from datadimensionitem where dataelementid > 0) order by name ) SELECT 'agg_des_no_analysis' as indicator, COUNT(*) as value, ROUND(( COUNT(*)::numeric / ( SELECT COUNT(*) FROM dataelement where domaintype = 'AGGREGATE' )::numeric) * 100)::varchar || '%' as percent, 'Aggregate data elements not used in any favourites (directly or through indicators)' as description FROM des_no_analysis;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"EFyNHwRu9w8","name":"aggregate_des_no_analysis_D","description":"Dashboards with 1 or fewer views over the past three years","sqlQuery":"select name,uid from dataelement where domaintype = 'AGGREGATE' and dataelementid not in (select de.dataelementid from dataelement de left join indicator ind on (ind.numerator like '%'||de.uid||'%' or ind.denominator like '%'||de.uid||'%') where ind.name is not null and ind.indicatorid in (select indicatorid from datadimensionitem where indicatorid > 0)) and dataelementid not in (select dataelementoperand_dataelementid from datadimensionitem where dataelementoperand_dataelementid > 0) and dataelementid not in (select dataelementid from datadimensionitem where dataelementid > 0) order by name;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"hN9QvyXRdQC","name":"des_no_orgunits_S","description":"Aggregate data elements assigned to 1 or less orgunit","sqlQuery":"WITH des_no_orgunits AS ( select uid,name from dataelement where (dataelementid not in (select dataelementid from datasetelement)) or (dataelementid in (select dataelementid from datasetelement where datasetid not in (select datasetid from datasetsource)) or (dataelementid in (select dataelementid from dataelement de left join datasetelement dse using (dataelementid) left join datasetsource dss using (datasetid) group by dataelementid having count(dss.*) = 1))) order by name ) SELECT 'des_no_orgunits' as indicator, COUNT(*) as value, ROUND(( COUNT(*)::numeric / ( SELECT COUNT(*) FROM dataelement where domaintype = 'AGGREGATE' )::numeric) * 100)::varchar || '%' as percent, 'Aggregate data elements assigned to 1 or less orgunit' as description FROM des_no_orgunits;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"xdx9XquVi30","name":"des_no_orgunits_D","description":"Aggregate data elements assigned to 1 or less orgunit","sqlQuery":"select uid,name from dataelement where (dataelementid not in (select dataelementid from datasetelement)) or (dataelementid in (select dataelementid from datasetelement where datasetid not in (select datasetid from datasetsource)) or (dataelementid in (select dataelementid from dataelement de left join datasetelement dse using (dataelementid) left join datasetsource dss using (datasetid) group by dataelementid having count(dss.*) = 1))) order by name","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"BsJqjX8CK2y","name":"assessment_dashboards_no_views_1y_S","description":"Dashboards not viewed in the past one year","sqlQuery":"select 'dashboard_used1y' as indicator, count(*)::varchar as value, (100*count(*)/(select count(*) from dashboard))||'%' as percent, 'Dashboards that have not been opened in the last 12 months' as description from dashboard where not uid in (select favoriteuid from datastatisticsevent where eventtype = 'DASHBOARD_VIEW' and favoriteuid is not null and timestamp > (now() - INTERVAL '12 months') group by favoriteuid);","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"dEwPGTpXYY2","name":"assessment_dashboards_no_views_1y_D","description":" Dashboards not viewed in the past year","sqlQuery":"SELECT uid,name from dashboard where not uid in (select favoriteuid from datastatisticsevent where eventtype = 'DASHBOARD_VIEW' and favoriteuid is not null and timestamp > (now() - INTERVAL '12 months') group by favoriteuid);","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"G7Z1WmUiuuR","name":"assessment_dashboards_S","description":"Total number of dashboards in the system","sqlQuery":"select 'dashboard_count' as indicator, count(*)::varchar as value, '100%' as percent, 'Total number of dashboards' as description from dashboard;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"WAgKp3hIWzF","name":"assessment_dashboards_D","description":"List of dashboards","sqlQuery":"select uid,name from dashboard LIMIT 1000;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"SdTkaAOPwFM","name":"dataset_summary_S","description":"Total number of data sets","sqlQuery":"with ds_lastupdate as (select datasetid, avg(date_part('day', pe.enddate::timestamp - pe.startdate::timestamp))::int as interval from dataset ds left join period pe using(periodtypeid) group by datasetid), ds_period as (select datasetid, dataelementid, periodid from dataset ds left join period pe using(periodtypeid) left join datasetelement using(datasetid) where date_part('day', now() - pe.enddate::timestamp)::int <= 3*date_part('day', pe.enddate::timestamp - pe.startdate::timestamp)::int) select 'dataset_count' as indicator, count(*)::varchar as value, '100%' as percent, 'Total number of data sets' as description from dataset;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"Ijyn3sXlmgw","name":"dataset_summary_D","description":"Datasets in the system","sqlQuery":"SELECT uid,name from dataset ORDER BY name;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"jliUzKxgkkH","name":"datasets_abandoned_S","description":"Data sets that have not been changed in last 100 days and are assigned to 1 or less orgunits","sqlQuery":"select 'dataset_abandoned' as indicator, count(*)::varchar as value , (100*count(*)/(select count(*) from dataset)) || '%' as percent, 'Data sets that have not been changed in last 100 days and are assigned to 1 or less orgunits' as description from dataset where date_part('day', now() - lastupdated::date) > 100 and (datasetid not in (select datasetid from datasetsource) or datasetid in (select datasetid from datasetsource group by datasetid having count(*) = 1));","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"Uj63Zrxixeq","name":"datasets_abandoned_D","description":"Abandoned datasets","sqlQuery":"SELECT uid,name from dataset where date_part('day', now() - lastupdated::date) > 100 and (datasetid not in (select datasetid from datasetsource) or datasetid in (select datasetid from datasetsource group by datasetid having count(*) = 1)); ORDER BY name;","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"mQ8XfW10fOQ","name":"empty_dashboards_S","description":"Total number of dashboards with no items","sqlQuery":"select 'dashboard_empty' as indicator, count(*)::varchar as value, (100*count(*)/(select count(*) from dashboard))||'%' as percent, 'Dashboards with no content' as description from dashboard where dashboardid not in (select dashboardid from dashboard_items);","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}},{"id":"NMZhvSZpTtW","name":"empty_dashboards_D","description":"List of dashboards with no items","sqlQuery":"SELECT uid,name from dashboard WHERE dashboardid not in (select dashboardid from dashboard_items);","type":"QUERY","sharing":{"external":false,"public":"rwr-----"}}]}